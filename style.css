// Mock admin login check (change this to a real authentication mechanism)
const isAdmin = true; // Change this to false to simulate a non-admin user

// Load saved anime recommendations from localStorage
document.addEventListener("DOMContentLoaded", function() {
  const savedAnimes = JSON.parse(localStorage.getItem("animeList")) || [];
  savedAnimes.forEach(function(anime) {
    addAnimeToList(anime.title, anime.genre, anime.image, isAdmin);
  });

  // Show admin section if the user is the admin
  if (isAdmin) {
    document.getElementById("admin-section").style.display = "block";
  }
});

document.getElementById("animeForm").addEventListener("submit", function(event) {
  event.preventDefault();

  const title = document.getElementById("animeTitle").value;
  const genre = document.getElementById("animeGenre").value;
  const image = document.getElementById("animeImage").value;

  // Add new anime to the list
  addAnimeToList(title, genre, image, true);

  // Save the new anime recommendation to localStorage
  const savedAnimes = JSON.parse(localStorage.getItem("animeList")) || [];
  savedAnimes.push({ title: title, genre: genre, image: image });
  localStorage.setItem("animeList", JSON.stringify(savedAnimes));

  // Clear form inputs
  document.getElementById("animeTitle").value = '';
  document.getElementById("animeGenre").value = '';
  document.getElementById("animeImage").value = '';
});

// Function to add anime to the DOM
function addAnimeToList(title, genre, image, isAdmin) {
  const animeList = document.getElementById("anime-list");
  const animeCard = document.createElement("div");
  animeCard.classList.add("anime-card");

  const animeTitle = document.createElement("h3");
  animeTitle.textContent = title;

  const animeGenre = document.createElement("p");
  animeGenre.textContent = `Genre: ${genre}`;
  animeGenre.classList.add("genre");

  const animeImage = document.createElement("img");
  animeImage.src = image;

  animeCard.appendChild(animeImage);
  animeCard.appendChild(animeTitle);
  animeCard.appendChild(animeGenre);

  if (isAdmin) {
    const deleteButton = document.createElement("button");
    deleteButton.textContent = "Delete";
    deleteButton.classList.add("delete-btn");
    deleteButton.onclick = function() {
      // Remove from DOM
      animeCard.remove();

      // Remove from localStorage
      const savedAnimes = JSON.parse(localStorage.getItem("animeList"));
      const updatedAnimes = savedAnimes.filter(anime => anime.title !== title);
      localStorage.setItem("animeList", JSON.stringify(updatedAnimes));
    };

    animeCard.appendChild(deleteButton);
  }

  animeList.appendChild(animeCard);
}
#login-choice button {
  padding: 10px 20px;
  margin: 10px;
  cursor: pointer;
}

#admin-login-section, #admin-section {
  margin-top: 20px;
}
